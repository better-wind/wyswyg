!function(a){function b(b,d,e){function f(){isfirst&&m.html("中奖"),isfirst=!1}function g(a){a.preventDefault(),mousedown=!0,f()}function h(a){a.preventDefault(),mousedown=!1,i()}function i(){for(var a=0,c=o.getImageData(0,0,d,e),f=c.data.length,g=0;f>g;g++)0==c.data[g]&&a++;a>=f*b&&k&&k()}function j(b){if(b.preventDefault(),mousedown){b.changedTouches&&(b=b.changedTouches[b.changedTouches.length-1]);var c=(b.clientX+a(document).scrollLeft()||b.pageX)-canvasLeft-ggl_navLeft-ggl_navmarginLeft||0,d=(b.clientY+a(document).scrollTop()||b.pageY)-canvasTop-ggl_navTop-ggl_navmarginTop||0;console.log(b.clientX+","+b.clientY+"    "+b.pageX+","+b.pageY+"    "+c+","+d),o.beginPath(),o.arc(c,d,15,0,2*Math.PI),o.fill()}}var k,l=a(".ggl"),m=a(".ggl p"),n=document.getElementById("myCanvas"),o=n.getContext("2d"),p=new Image;p.src="http://xqproduct.xiangqu.com/FuKC89BO6DLCnppV8EKM2Ea0dkNu?imageView2/2/w/434/q/100/format/jpg/434x241/",p.onload=function(){n.width=d,n.height=e,o.drawImage(p,0,0,n.width,n.height),o.globalCompositeOperation="destination-out"},canvasLeft=n.offsetLeft,canvasTop=n.offsetTop,mousedown=!1,isfirst=!0,ggl_navmarginLeft=parseInt(c(l.css("margin-left"))),ggl_navmarginTop=parseInt(c(l.css("margin-top"))),ggl_navLeft=l.position().left,ggl_navTop=l.position().top,n.addEventListener("touchstart",g),n.addEventListener("touchend",h),n.addEventListener("touchmove",j),this.finish=function(a){k=a},this.clear=function(){o.beginPath(),o.rect(0,0,d,e),o.fill(),alert("success"),n.removeEventListener("touchstart",g),n.removeEventListener("touchend",h),n.removeEventListener("touchmove",j)}}function c(a){if(!a)return!1;var b=a.split("px");return b[0]}var d={init:function(){var b=this;b.loginURL=a("body").attr("data-loginUrl"),b.J_ggl=a(".ggl"),b.eventing()},eventing:function(){var a=this;a.more_li_init(),a.ggl_init()},more_li_init:function(){var b=this;b.J_more_ul=a(".more_ul"),b.J_more_li=a(".more_ul li")},ggl_init:function(){var c=.828*a("body").width()*.828,d=.9*a(".ggl").height(),e=new b(.5,c,d);e.finish(function(){e.clear()})},login:function(){var a=this;""!=a.loginURL?a.loginURL.indexOf("http://")>=0?location.href=a.loginURL+"?redirectUrl="+location.href:location.href=a.loginURL:alert("�����µ�¼��")}};a(function(){d.init()})}(Zepto);